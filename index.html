import React, { useState } from 'react';
import { BookOpen, Activity, PlayCircle, CheckCircle, HelpCircle, TrendingUp, TrendingDown, Users, ShoppingCart, Award } from 'lucide-react';

const App = () => {
  const [activeTab, setActiveTab] = useState(0);

  const tabs = [
    { id: 0, title: 'Asesmen Awal', icon: <Activity size={20} /> },
    { id: 1, title: 'Ice Breaking', icon: <PlayCircle size={20} /> },
    { id: 2, title: 'Materi: Konsep', icon: <BookOpen size={20} /> },
    { id: 3, title: 'Materi: Harga Pasar', icon: <TrendingUp size={20} /> },
    { id: 4, title: 'Latihan Soal', icon: <CheckCircle size={20} /> },
    { id: 5, title: 'Refleksi', icon: <HelpCircle size={20} /> },
  ];

  return (
    <div className="min-h-screen bg-gray-50 font-sans text-gray-800">
      {/* Header */}
      <header className="bg-blue-600 text-white p-4 shadow-md">
        <div className="max-w-5xl mx-auto flex items-center justify-between">
          <div>
            <h1 className="text-2xl font-bold">IPS Terpadu Kelas 8</h1>
            <p className="text-blue-100 text-sm">Modul Interaktif: Permintaan, Penawaran, dan Harga Pasar</p>
          </div>
          <div className="hidden md:block text-right text-sm opacity-90">
            Guru Pengampu: Bapak/Ibu Guru IPS
          </div>
        </div>
      </header>

      {/* Main Content Layout */}
      <div className="max-w-5xl mx-auto mt-6 p-4 md:flex gap-6">
        
        {/* Sidebar Navigation */}
        <nav className="md:w-64 flex-shrink-0 mb-6 md:mb-0">
          <div className="bg-white rounded-lg shadow-sm overflow-hidden border border-gray-200">
            {tabs.map((tab) => (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                className={`w-full flex items-center gap-3 px-4 py-3 text-left transition-colors ${
                  activeTab === tab.id
                    ? 'bg-blue-50 text-blue-700 border-l-4 border-blue-600 font-medium'
                    : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'
                }`}
              >
                {tab.icon}
                <span>{tab.title}</span>
              </button>
            ))}
          </div>
          
          <div className="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-100 text-sm text-blue-800">
            <p className="font-semibold mb-1">Tips Guru:</p>
            <p>Gunakan tab secara berurutan mulai dari Asesmen Awal hingga Refleksi.</p>
          </div>
        </nav>

        {/* Content Area */}
        <main className="flex-1 bg-white rounded-xl shadow-sm border border-gray-200 min-h-[500px] p-6 relative">
          {activeTab === 0 && <AsesmenAwal />}
          {activeTab === 1 && <IceBreaking />}
          {activeTab === 2 && <MateriKonsep />}
          {activeTab === 3 && <MateriHargaPasar />}
          {activeTab === 4 && <LatihanSoal />}
          {activeTab === 5 && <Refleksi />}
        </main>
      </div>
    </div>
  );
};

// --- TAB 1: ASESMEN AWAL ---
const AsesmenAwal = () => {
  const [answers, setAnswers] = useState({});
  const [submitted, setSubmitted] = useState(false);

  const questions = [
    { id: 1, text: "Pasar harus selalu berupa bangunan fisik seperti gedung atau toko.", correct: false },
    { id: 2, text: "Jika harga barang murah, biasanya pembeli ingin membeli lebih banyak.", correct: true },
    { id: 3, text: "Produsen adalah pihak yang menggunakan atau menghabiskan nilai guna barang.", correct: false },
    { id: 4, text: "Tawar-menawar adalah cara untuk mencapai kesepakatan harga.", correct: true },
    { id: 5, text: "Jika barang langka tapi banyak yang butuh, harga cenderung naik.", correct: true },
    { id: 6, text: "Keseimbangan pasar terjadi saat Pembeli dan Penjual sepakat pada harga tertentu.", correct: true },
    { id: 7, text: "Hukum permintaan dilihat dari sudut pandang Penjual.", correct: false },
    { id: 8, text: "Diskon biasanya diberikan saat penjual ingin meningkatkan penjualan.", correct: true },
    { id: 9, text: "Pasar online (e-commerce) tidak termasuk dalam pengertian pasar ekonomi.", correct: false },
    { id: 10, text: "Uang berfungsi sebagai alat tukar yang sah.", correct: true },
  ];

  const handleAnswer = (id, val) => {
    if (submitted) return;
    setAnswers({ ...answers, [id]: val });
  };

  const calculateScore = () => {
    let score = 0;
    questions.forEach(q => {
      if (answers[q.id] === q.correct) score += 10;
    });
    return score;
  };

  return (
    <div className="space-y-6">
      <div className="border-b pb-4">
        <h2 className="text-2xl font-bold text-gray-800">Asesmen Awal (Diagnostik)</h2>
        <p className="text-gray-600">Jawablah Benar atau Salah untuk mengecek pemahaman dasarmu sebelum kita mulai!</p>
      </div>

      <div className="space-y-4">
        {questions.map((q, idx) => (
          <div key={q.id} className="flex flex-col sm:flex-row sm:items-center justify-between p-3 bg-gray-50 rounded-lg border hover:bg-gray-100">
            <span className="mb-2 sm:mb-0 text-sm md:text-base font-medium text-gray-700">{idx + 1}. {q.text}</span>
            <div className="flex gap-2">
              <button
                onClick={() => handleAnswer(q.id, true)}
                className={`px-4 py-1 rounded-full text-sm font-bold transition-colors ${
                  answers[q.id] === true
                    ? 'bg-blue-600 text-white'
                    : 'bg-white text-gray-500 border hover:bg-blue-50'
                } ${submitted && q.correct ? 'ring-2 ring-green-500' : ''}`}
              >
                Benar
              </button>
              <button
                onClick={() => handleAnswer(q.id, false)}
                className={`px-4 py-1 rounded-full text-sm font-bold transition-colors ${
                  answers[q.id] === false
                    ? 'bg-red-500 text-white'
                    : 'bg-white text-gray-500 border hover:bg-red-50'
                } ${submitted && !q.correct ? 'ring-2 ring-green-500' : ''}`}
              >
                Salah
              </button>
            </div>
          </div>
        ))}
      </div>

      <div className="pt-4">
        {!submitted ? (
          <button
            onClick={() => setSubmitted(true)}
            disabled={Object.keys(answers).length < 10}
            className="w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"
          >
            Cek Hasil
          </button>
        ) : (
          <div className="bg-green-100 border border-green-200 text-green-800 p-4 rounded-lg text-center">
            <h3 className="text-xl font-bold">Nilai Kamu: {calculateScore()} / 100</h3>
            <p>{calculateScore() > 70 ? "Hebat! Kamu sudah punya dasar ekonomi yang baik." : "Tidak apa-apa, mari kita pelajari lebih dalam di materi selanjutnya!"}</p>
            <button onClick={() => { setSubmitted(false); setAnswers({}); }} className="mt-2 text-sm text-green-700 underline">Ulangi Tes</button>
          </div>
        )}
      </div>
    </div>
  );
};

// --- TAB 2: ICE BREAKING ---
const IceBreaking = () => {
  const [scenario, setScenario] = useState(0);
  const [feedback, setFeedback] = useState(null);

  const scenarios = [
    {
      id: 1,
      title: "Kasus: Lebaran Idul Fitri",
      desc: "Besok adalah hari raya Idul Fitri. Apa yang terjadi pada harga daging sapi di pasar?",
      options: [
        { label: "Harga Naik Tajam üìà", correct: true, reason: "Betul! Karena permintaan sangat tinggi sedangkan stok terbatas." },
        { label: "Harga Turun Drastis üìâ", correct: false, reason: "Kurang tepat. Penjual justru menaikkan harga karena banyak yang cari." }
      ]
    },
    {
      id: 2,
      title: "Kasus: Panen Raya Mangga",
      desc: "Di semua desa sedang panen mangga serentak. Stok mangga melimpah ruah di pinggir jalan. Apa yang terjadi pada harga?",
      options: [
        { label: "Harga Mahal", correct: false, reason: "Salah. Kalau barang melimpah (banjir stok), harga justru jatuh." },
        { label: "Harga Murah / Obral", correct: true, reason: "Tepat! Supply berlebih membuat penjual banting harga agar laku." }
      ]
    },
    {
      id: 3,
      title: "Kasus: Artis K-Pop",
      desc: "Seorang Idol K-Pop terkenal memakai topi merek 'X'. Tiba-tiba topi itu viral. Apa efeknya ke harga pasar topi itu?",
      options: [
        { label: "Harga Naik", correct: true, reason: "Ya! Selera masyarakat meningkat tajam membuat permintaan naik -> harga naik." },
        { label: "Harga Tetap", correct: false, reason: "Kurang tepat. Pedagang pasti memanfaatkan momen viral untuk menaikkan harga." }
      ]
    }
  ];

  const handleChoice = (isCorrect, reason) => {
    setFeedback({ isCorrect, reason });
  };

  const nextScenario = () => {
    setFeedback(null);
    if (scenario < scenarios.length - 1) {
      setScenario(scenario + 1);
    } else {
      setScenario(0); // Reset loop
    }
  };

  const current = scenarios[scenario];

  return (
    <div className="flex flex-col items-center justify-center h-full text-center space-y-8 py-8">
      <div className="bg-gradient-to-r from-purple-500 to-indigo-600 text-white px-6 py-2 rounded-full font-bold shadow-lg flex items-center gap-2">
        <Activity size={20} />
        Ice Breaking: Tebak Tren Pasar!
      </div>

      <div className="max-w-md w-full bg-white p-8 rounded-2xl shadow-xl border-2 border-indigo-100 relative overflow-hidden">
        <div className="absolute top-0 left-0 w-full h-2 bg-gray-200">
           <div className="h-full bg-indigo-500 transition-all duration-500" style={{ width: `${((scenario + 1) / scenarios.length) * 100}%` }}></div>
        </div>

        <h3 className="text-xl font-bold text-gray-800 mb-2">{current.title}</h3>
        <p className="text-gray-600 mb-8 min-h-[80px] flex items-center justify-center">{current.desc}</p>

        {!feedback ? (
          <div className="grid grid-cols-2 gap-4">
            {current.options.map((opt, idx) => (
              <button
                key={idx}
                onClick={() => handleChoice(opt.correct, opt.reason)}
                className="py-4 px-2 bg-indigo-50 text-indigo-700 rounded-xl font-bold hover:bg-indigo-100 hover:scale-105 transition-all border border-indigo-200"
              >
                {opt.label}
              </button>
            ))}
          </div>
        ) : (
          <div className="animate-fade-in-up">
            <div className={`p-4 rounded-xl mb-4 ${feedback.isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
              <p className="font-bold text-lg mb-1">{feedback.isCorrect ? "üéâ Benar Sekali!" : "üòÖ Kurang Tepat!"}</p>
              <p>{feedback.reason}</p>
            </div>
            <button
              onClick={nextScenario}
              className="px-6 py-2 bg-indigo-600 text-white rounded-full font-semibold hover:bg-indigo-700 shadow-lg"
            >
              {scenario < scenarios.length - 1 ? "Soal Berikutnya" : "Ulangi Game"}
            </button>
          </div>
        )}
      </div>
      <p className="text-sm text-gray-400">Game logika ekonomi sederhana</p>
    </div>
  );
};

// --- TAB 3: MATERI KONSEP ---
const MateriKonsep = () => {
  return (
    <div className="space-y-8 animate-fade-in">
      <div className="border-l-4 border-blue-500 pl-4">
        <h2 className="text-3xl font-bold text-gray-800">Permintaan & Penawaran</h2>
        <p className="text-gray-600 mt-1">Dua kekuatan utama yang menggerakkan pasar.</p>
      </div>

      <div className="grid md:grid-cols-2 gap-6">
        {/* Permintaan */}
        <div className="bg-orange-50 p-6 rounded-xl border border-orange-200 shadow-sm hover:shadow-md transition-shadow">
          <div className="flex items-center gap-3 mb-4">
            <div className="p-3 bg-orange-100 text-orange-600 rounded-full">
              <ShoppingCart size={24} />
            </div>
            <h3 className="text-xl font-bold text-orange-800">Permintaan (Demand)</h3>
          </div>
          <p className="text-gray-700 mb-4 text-sm leading-relaxed">
            Keinginan konsumen untuk membeli suatu barang pada berbagai tingkat harga dalam waktu tertentu.
            <br/><br/>
            <strong>Sudut Pandang:</strong> <span className="text-orange-600 font-bold">PEMBELI</span>
          </p>
          <div className="bg-white p-4 rounded-lg border border-orange-100">
            <h4 className="font-bold text-orange-900 mb-2 border-b pb-2">Hukum Permintaan:</h4>
            <div className="flex items-center justify-between text-center font-medium">
              <div className="bg-red-50 p-2 rounded">
                <p className="text-xs text-gray-500">Harga</p>
                <p className="text-red-600 text-lg">NAIK ‚¨Ü</p>
              </div>
              <span className="text-gray-400">‚û°Ô∏è</span>
              <div className="bg-blue-50 p-2 rounded">
                <p className="text-xs text-gray-500">Jumlah Minta</p>
                <p className="text-blue-600 text-lg">TURUN ‚¨á</p>
              </div>
            </div>
            <p className="text-xs text-center mt-2 text-gray-500 italic">"Makin mahal, makin malas beli"</p>
          </div>
        </div>

        {/* Penawaran */}
        <div className="bg-emerald-50 p-6 rounded-xl border border-emerald-200 shadow-sm hover:shadow-md transition-shadow">
          <div className="flex items-center gap-3 mb-4">
            <div className="p-3 bg-emerald-100 text-emerald-600 rounded-full">
              <Users size={24} />
            </div>
            <h3 className="text-xl font-bold text-emerald-800">Penawaran (Supply)</h3>
          </div>
          <p className="text-gray-700 mb-4 text-sm leading-relaxed">
            Jumlah barang yang ingin dijual oleh produsen pada berbagai tingkat harga dalam waktu tertentu.
            <br/><br/>
            <strong>Sudut Pandang:</strong> <span className="text-emerald-600 font-bold">PENJUAL</span>
          </p>
          <div className="bg-white p-4 rounded-lg border border-emerald-100">
            <h4 className="font-bold text-emerald-900 mb-2 border-b pb-2">Hukum Penawaran:</h4>
            <div className="flex items-center justify-between text-center font-medium">
              <div className="bg-red-50 p-2 rounded">
                <p className="text-xs text-gray-500">Harga</p>
                <p className="text-red-600 text-lg">NAIK ‚¨Ü</p>
              </div>
              <span className="text-gray-400">‚û°Ô∏è</span>
              <div className="bg-blue-50 p-2 rounded">
                <p className="text-xs text-gray-500">Jumlah Jual</p>
                <p className="text-blue-600 text-lg">NAIK ‚¨Ü</p>
              </div>
            </div>
            <p className="text-xs text-center mt-2 text-gray-500 italic">"Makin mahal, makin semangat jualan"</p>
          </div>
        </div>
      </div>

      <div className="bg-blue-50 p-4 rounded-lg border border-blue-200 text-sm">
        <strong>üí° Ceteris Paribus:</strong> Hukum di atas hanya berlaku jika faktor lain (selera, pendapatan, teknologi) dianggap tetap/tidak berubah.
      </div>
    </div>
  );
};

// --- TAB 4: MATERI HARGA PASAR (SIMULASI) ---
const MateriHargaPasar = () => {
  const [highlightRow, setHighlightRow] = useState(null);

  const data = [
    { price: 10000, demand: 50, supply: 10, status: "Kekurangan (Shortage)" },
    { price: 12000, demand: 40, supply: 20, status: "Kekurangan" },
    { price: 15000, demand: 30, supply: 30, status: "SEIMBANG (E)" },
    { price: 18000, demand: 20, supply: 40, status: "Kelebihan (Surplus)" },
    { price: 20000, demand: 10, supply: 50, status: "Kelebihan" },
  ];

  return (
    <div className="space-y-6">
      <div className="border-b pb-4">
        <h2 className="text-2xl font-bold text-gray-800">Terbentuknya Harga Pasar</h2>
        <p className="text-gray-600">Harga pasar terjadi saat Jumlah Permintaan (Qd) = Jumlah Penawaran (Qs).</p>
      </div>

      <div className="flex flex-col md:flex-row gap-8">
        {/* Tabel */}
        <div className="flex-1">
          <h3 className="font-bold text-lg mb-3 flex items-center gap-2">
            <span className="bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm">Contoh</span>
            Pasar Bakso
          </h3>
          <div className="overflow-hidden rounded-lg border border-gray-200">
            <table className="w-full text-sm text-left">
              <thead className="bg-gray-100 text-gray-700 uppercase font-bold">
                <tr>
                  <th className="px-4 py-3">Harga (Rp)</th>
                  <th className="px-4 py-3">Pembeli (Qd)</th>
                  <th className="px-4 py-3">Penjual (Qs)</th>
                  <th className="px-4 py-3">Status</th>
                </tr>
              </thead>
              <tbody>
                {data.map((row, idx) => (
                  <tr
                    key={idx}
                    onMouseEnter={() => setHighlightRow(idx)}
                    onMouseLeave={() => setHighlightRow(null)}
                    className={`cursor-pointer transition-colors ${
                      row.demand === row.supply ? 'bg-green-100 font-bold border-l-4 border-green-500' : 
                      highlightRow === idx ? 'bg-blue-50' : 'bg-white border-b'
                    }`}
                  >
                    <td className="px-4 py-3">{row.price.toLocaleString()}</td>
                    <td className="px-4 py-3">{row.demand}</td>
                    <td className="px-4 py-3">{row.supply}</td>
                    <td className={`px-4 py-3 ${row.demand === row.supply ? 'text-green-700' : 'text-gray-500'}`}>
                      {row.status}
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
          <p className="text-xs text-gray-500 mt-2">*Arahkan mouse ke tabel untuk fokus</p>
        </div>

        {/* Visualisasi Kurva Sederhana SVG */}
        <div className="flex-1 flex flex-col items-center justify-center bg-gray-50 rounded-xl p-4 border border-gray-200">
          <h3 className="font-bold text-gray-700 mb-4">Kurva Keseimbangan (Equilibrium)</h3>
          <div className="relative w-64 h-64 bg-white border-l-2 border-b-2 border-gray-800 p-4">
            {/* Labels */}
            <span className="absolute -left-8 top-0 text-xs font-bold transform -rotate-90">Harga (P)</span>
            <span className="absolute bottom-[-25px] right-0 text-xs font-bold">Jumlah (Q)</span>
            
            {/* Demand Curve (Down) */}
            <svg className="absolute top-0 left-0 w-full h-full pointer-events-none">
              <line x1="10" y1="10" x2="220" y2="220" stroke="#f97316" strokeWidth="3" />
              <text x="200" y="210" fill="#f97316" fontWeight="bold" fontSize="12">D (Permintaan)</text>
              
              {/* Supply Curve (Up) */}
              <line x1="10" y1="220" x2="220" y2="10" stroke="#10b981" strokeWidth="3" />
              <text x="200" y="30" fill="#10b981" fontWeight="bold" fontSize="12">S (Penawaran)</text>

              {/* Equilibrium Point */}
              <circle cx="115" cy="115" r="6" fill="#2563eb" />
              
              {/* Dashed Lines */}
              <line x1="115" y1="115" x2="0" y2="115" stroke="#94a3b8" strokeWidth="2" strokeDasharray="4" />
              <line x1="115" y1="115" x2="115" y2="240" stroke="#94a3b8" strokeWidth="2" strokeDasharray="4" />

              <text x="125" y="110" fill="#2563eb" fontWeight="bold" fontSize="12">E (Titik Temu)</text>
              <text x="5" y="110" fill="#64748b" fontSize="10">Rp15.000</text>
              <text x="110" y="235" fill="#64748b" fontSize="10">30 Unit</text>
            </svg>
          </div>
          <div className="mt-4 text-xs text-gray-600 text-center bg-white p-2 rounded shadow-sm">
            Titik <strong>E</strong> adalah saat Pembeli & Penjual "Salaman" (Sepakat).
          </div>
        </div>
      </div>
    </div>
  );
};

// --- TAB 5: LATIHAN SOAL ---
const LatihanSoal = () => {
  const [currentQ, setCurrentQ] = useState(0);
  const [score, setScore] = useState(0);
  const [showResult, setShowResult] = useState(false);
  const [selected, setSelected] = useState(null);

  const questions = [
    {
      q: "Kurva permintaan memiliki kemiringan (slope) negatif. Artinya bergerak dari...",
      options: ["Kiri bawah ke kanan atas", "Kiri atas ke kanan bawah", "Tegak lurus vertikal", "Mendatar horizontal"],
      a: 1
    },
    {
      q: "Jika harga Rp2.000, permintaan 100 dan penawaran 50. Apa yang terjadi?",
      options: ["Harga Pasar tercapai", "Surplus (Kelebihan barang)", "Shortage (Kekurangan barang)", "Tidak ada transaksi"],
      a: 2
    },
    {
      q: "Faktor apa yang bisa menggeser kurva permintaan ke kanan (naik) walau harga tetap?",
      options: ["Biaya produksi naik", "Teknologi mesin baru", "Pendapatan masyarakat naik", "Harga barang itu sendiri naik"],
      a: 2
    },
    {
      q: "Rumus keseimbangan pasar adalah...",
      options: ["Qd = Qs", "Qd > Qs", "Qd < Qs", "Qd + Qs = 0"],
      a: 0
    },
    {
      q: "Siapa yang menentukan harga pasar dalam sistem ekonomi bebas?",
      options: ["Hanya Pemerintah", "Hanya Penjual", "Hanya Pembeli", "Kesepakatan Penjual dan Pembeli"],
      a: 3
    }
  ];

  const handleSelect = (idx) => {
    setSelected(idx);
  };

  const nextQuestion = () => {
    if (selected === questions[currentQ].a) {
      setScore(score + 20);
    }
    
    if (currentQ < questions.length - 1) {
      setCurrentQ(currentQ + 1);
      setSelected(null);
    } else {
      setShowResult(true);
    }
  };

  if (showResult) {
    return (
      <div className="text-center py-10 space-y-6 animate-fade-in">
        <Award className="w-20 h-20 text-yellow-500 mx-auto" />
        <h2 className="text-3xl font-bold text-gray-800">Hasil Latihan</h2>
        <div className="text-5xl font-bold text-blue-600">{score} <span className="text-xl text-gray-400">/ 100</span></div>
        <p className="text-gray-600">
          {score === 100 ? "Luar Biasa! Sempurna!" : score >= 60 ? "Bagus! Terus berlatih ya." : "Jangan menyerah, baca materinya lagi!"}
        </p>
        <button
          onClick={() => { setShowResult(false); setCurrentQ(0); setScore(0); setSelected(null); }}
          className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition"
        >
          Coba Lagi
        </button>
      </div>
    );
  }

  return (
    <div className="max-w-2xl mx-auto py-6">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-xl font-bold text-gray-700">Latihan Soal</h2>
        <span className="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-bold">
          Soal {currentQ + 1} dari {questions.length}
        </span>
      </div>

      <div className="bg-white p-6 rounded-xl shadow-sm border mb-6">
        <p className="text-lg font-medium text-gray-800 mb-6">{questions[currentQ].q}</p>
        <div className="space-y-3">
          {questions[currentQ].options.map((opt, idx) => (
            <button
              key={idx}
              onClick={() => handleSelect(idx)}
              className={`w-full text-left p-4 rounded-lg border transition-all ${
                selected === idx
                  ? 'bg-blue-600 text-white border-blue-600 ring-2 ring-blue-300'
                  : 'bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100'
              }`}
            >
              {['A', 'B', 'C', 'D'][idx]}. {opt}
            </button>
          ))}
        </div>
      </div>

      <button
        onClick={nextQuestion}
        disabled={selected === null}
        className="w-full bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition"
      >
        {currentQ === questions.length - 1 ? "Lihat Hasil" : "Lanjut"}
      </button>
    </div>
  );
};

// --- TAB 6: REFLEKSI ---
const Refleksi = () => {
  const [notes, setNotes] = useState({ learn: '', confuse: '', feel: '' });
  const [saved, setSaved] = useState(false);

  const handleSubmit = (e) => {
    e.preventDefault();
    setSaved(true);
  };

  return (
    <div className="max-w-2xl mx-auto space-y-6">
      <div className="border-b pb-4">
        <h2 className="text-2xl font-bold text-gray-800">Refleksi Pembelajaran</h2>
        <p className="text-gray-600">Tiket keluar (Exit Ticket) sebelum menutup pelajaran hari ini.</p>
      </div>

      {!saved ? (
        <form onSubmit={handleSubmit} className="space-y-6">
          <div>
            <label className="block text-sm font-bold text-gray-700 mb-2">
              1. Satu hal baru yang saya pelajari hari ini tentang Pasar:
            </label>
            <textarea
              className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
              rows={3}
              placeholder="Contoh: Saya baru tahu kalau harga terbentuk karena kesepakatan..."
              value={notes.learn}
              onChange={(e) => setNotes({ ...notes, learn: e.target.value })}
              required
            />
          </div>

          <div>
            <label className="block text-sm font-bold text-gray-700 mb-2">
              2. Satu hal yang masih membuat saya bingung:
            </label>
            <textarea
              className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
              rows={2}
              placeholder="Contoh: Mengapa kurva penawaran naik ke kanan?"
              value={notes.confuse}
              onChange={(e) => setNotes({ ...notes, confuse: e.target.value })}
            />
          </div>

          <div>
            <label className="block text-sm font-bold text-gray-700 mb-2">
              3. Perasaan saya saat belajar materi ini:
            </label>
            <div className="flex gap-4">
              {['ü§© Seru', 'üôÇ Paham', 'üòê Biasa Saja', 'ü§Ø Pusing'].map((emoji) => (
                <button
                  type="button"
                  key={emoji}
                  onClick={() => setNotes({ ...notes, feel: emoji })}
                  className={`px-4 py-2 rounded-full border ${
                    notes.feel === emoji ? 'bg-blue-100 border-blue-500 text-blue-700 font-bold' : 'bg-white border-gray-200 text-gray-600 hover:bg-gray-50'
                  }`}
                >
                  {emoji}
                </button>
              ))}
            </div>
          </div>

          <button type="submit" className="bg-blue-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-blue-700 transition w-full md:w-auto">
            Kirim Refleksi
          </button>
        </form>
      ) : (
        <div className="bg-green-50 border border-green-200 p-8 rounded-xl text-center space-y-4 animate-scale-in">
          <CheckCircle className="w-16 h-16 text-green-500 mx-auto" />
          <h3 className="text-2xl font-bold text-gray-800">Terima Kasih!</h3>
          <p className="text-gray-600">Refleksimu sudah tercatat. Sampai jumpa di pelajaran Ekonomi berikutnya!</p>
          <div className="bg-white p-4 rounded border text-left text-sm text-gray-500 mt-4 mx-auto max-w-sm">
            <p><strong>Pelajaran:</strong> {notes.learn}</p>
            <p><strong>Bingung:</strong> {notes.confuse || "-"}</p>
            <p><strong>Mood:</strong> {notes.feel}</p>
          </div>
          <button onClick={() => setSaved(false)} className="text-blue-600 underline text-sm">Edit Jawaban</button>
        </div>
      )}
    </div>
  );
};

export default App;
